# ğŸ“¦ å¦‚ä½•åœ¨ Redis ä¸­æŸ¥çœ‹ basic é˜Ÿåˆ—

## ğŸ¯ å¿«é€Ÿæ–¹æ³•

### æ–¹æ³• 1: ä½¿ç”¨ Python è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# æŸ¥çœ‹ basic é˜Ÿåˆ—
python3 examples/view_redis_queue.py

# æˆ–ä½¿ç”¨å·²æœ‰çš„å·¥å…·
python3 redis_queue_viewer.py
```

### æ–¹æ³• 2: ä½¿ç”¨ Redis CLIï¼ˆæœ€ç›´æ¥ï¼‰

```bash
# 1. è¿æ¥ Redis
redis-cli

# 2. æŸ¥çœ‹é˜Ÿåˆ—é•¿åº¦
LLEN basic

# 3. æŸ¥çœ‹é˜Ÿåˆ—å†…å®¹ï¼ˆä¸åˆ é™¤ï¼‰
LRANGE basic 0 -1

# 4. æŸ¥çœ‹å‰ 10 ä¸ªä»»åŠ¡
LRANGE basic 0 9
```

---

## ğŸ“‹ è¯¦ç»†æ“ä½œæŒ‡å—

### ä½¿ç”¨ Redis CLI

#### 1. è¿æ¥ Redis

```bash
# åŸºæœ¬è¿æ¥
redis-cli

# æŒ‡å®šä¸»æœºå’Œç«¯å£
redis-cli -h localhost -p 6379

# æŒ‡å®šæ•°æ®åº“
redis-cli -n 0

# å¸¦å¯†ç è¿æ¥
redis-cli -a your_password
```

#### 2. æŸ¥çœ‹é˜Ÿåˆ—é•¿åº¦

```bash
# åœ¨ redis-cli ä¸­
LLEN basic

# è¿”å›ç¤ºä¾‹:
# (integer) 5
```

**è¯´æ˜**:
- `LLEN` è¿”å›åˆ—è¡¨çš„é•¿åº¦ï¼ˆä»»åŠ¡æ•°é‡ï¼‰
- ä¸ä¼šåˆ é™¤é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡

#### 3. æŸ¥çœ‹é˜Ÿåˆ—å†…å®¹ï¼ˆä¸åˆ é™¤ï¼‰

```bash
# æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡
LRANGE basic 0 -1

# æŸ¥çœ‹å‰ 10 ä¸ªä»»åŠ¡
LRANGE basic 0 9

# æŸ¥çœ‹ç¬¬ 1 ä¸ªåˆ°ç¬¬ 5 ä¸ªä»»åŠ¡
LRANGE basic 0 4
```

**è¯´æ˜**:
- `LRANGE key start stop`: è¿”å›åˆ—è¡¨æŒ‡å®šèŒƒå›´çš„å€¼
- `0 -1`: è¡¨ç¤ºä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªï¼ˆæ‰€æœ‰ï¼‰
- `0 9`: è¡¨ç¤ºå‰ 10 ä¸ªï¼ˆç´¢å¼• 0-9ï¼‰
- **ä¸ä¼šåˆ é™¤ä»»åŠ¡**ï¼Œåªæ˜¯æŸ¥çœ‹

**è¾“å‡ºç¤ºä¾‹**:
```
1) "{\"id\":\"abc123...\",\"task\":\"tasks.basic_tasks.hello_world\",\"args\":[42,42],...}"
2) "{\"id\":\"def456...\",\"task\":\"tasks.basic_tasks.add\",\"args\":[4,5],...}"
```

#### 4. æŸ¥çœ‹å¹¶åˆ é™¤ä»»åŠ¡ï¼ˆæ¶ˆè´¹ä»»åŠ¡ï¼‰

```bash
# é˜»å¡ç­‰å¾…å¹¶è·å–ä»»åŠ¡ï¼ˆWorker ä½¿ç”¨çš„æ–¹å¼ï¼‰
BRPOP basic 0

# éé˜»å¡è·å–ä»»åŠ¡
RPOP basic
```

**è¯´æ˜**:
- `BRPOP`: é˜»å¡å¼å³å¼¹å‡ºï¼Œä¼šåˆ é™¤ä»»åŠ¡
- `RPOP`: éé˜»å¡å³å¼¹å‡ºï¼Œä¼šåˆ é™¤ä»»åŠ¡
- **ä¼šåˆ é™¤ä»»åŠ¡**ï¼Œè°¨æ…ä½¿ç”¨

#### 5. æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…ï¼ˆæ ¼å¼åŒ– JSONï¼‰

ç”±äº Redis CLI è¿”å›çš„æ˜¯ JSON å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ ¼å¼åŒ–ï¼š

```bash
# æ–¹æ³• 1: ä½¿ç”¨ç®¡é“å’Œ jqï¼ˆéœ€è¦å®‰è£… jqï¼‰
redis-cli LRANGE basic 0 0 | jq .

# æ–¹æ³• 2: ä½¿ç”¨ Python è„šæœ¬
python3 examples/view_redis_queue.py
```

---

## ğŸ ä½¿ç”¨ Python è„šæœ¬

### æ–¹æ³• 1: ä½¿ç”¨é¡¹ç›®æä¾›çš„è„šæœ¬

```bash
# æŸ¥çœ‹ basic é˜Ÿåˆ—
python3 examples/view_redis_queue.py

# æŸ¥çœ‹æ‰€æœ‰é˜Ÿåˆ—
python3 redis_queue_viewer.py
```

### æ–¹æ³• 2: è‡ªå·±ç¼–å†™è„šæœ¬

```python
import redis
import json

# è¿æ¥ Redis
r = redis.Redis(host='localhost', port=6379, db=0, decode_responses=True)

# æŸ¥çœ‹é˜Ÿåˆ—é•¿åº¦
length = r.llen('basic')
print(f"é˜Ÿåˆ—é•¿åº¦: {length}")

# æŸ¥çœ‹é˜Ÿåˆ—å†…å®¹ï¼ˆä¸åˆ é™¤ï¼‰
items = r.lrange('basic', 0, 9)
for i, item in enumerate(items, 1):
    try:
        task_data = json.loads(item)
        print(f"\nä»»åŠ¡ {i}:")
        print(f"  ID: {task_data.get('id')}")
        print(f"  ä»»åŠ¡: {task_data.get('task')}")
        print(f"  å‚æ•°: {task_data.get('args')}")
    except json.JSONDecodeError:
        print(f"  åŸå§‹æ•°æ®: {item[:100]}...")
```

---

## ğŸ” æŸ¥çœ‹å…¶ä»–ç›¸å…³ä¿¡æ¯

### 1. æŸ¥çœ‹æ‰€æœ‰ Celery ç›¸å…³çš„é”®

```bash
# åœ¨ redis-cli ä¸­
KEYS *

# æˆ–åªæŸ¥çœ‹ Celery ç›¸å…³çš„
KEYS celery*

# æŸ¥çœ‹é˜Ÿåˆ—ç›¸å…³çš„
KEYS *queue*
```

### 2. æŸ¥çœ‹ä»»åŠ¡ç»“æœ

```bash
# éœ€è¦çŸ¥é“ä»»åŠ¡ ID
GET celery-task-meta-{task_id}

# ç¤ºä¾‹
GET celery-task-meta-abc123-def456-ghi789
```

### 3. æŸ¥çœ‹æ‰€æœ‰é˜Ÿåˆ—

```bash
# æŸ¥çœ‹æ‰€æœ‰é˜Ÿåˆ—çš„é•¿åº¦
LLEN celery
LLEN basic
LLEN advanced
LLEN realworld
```

---

## ğŸ› ï¸ å®ç”¨å‘½ä»¤é›†åˆ

### æŸ¥çœ‹é˜Ÿåˆ—çŠ¶æ€

```bash
# 1. æŸ¥çœ‹é˜Ÿåˆ—é•¿åº¦
LLEN basic

# 2. æŸ¥çœ‹é˜Ÿåˆ—å†…å®¹ï¼ˆå‰ 10 ä¸ªï¼‰
LRANGE basic 0 9

# 3. æŸ¥çœ‹é˜Ÿåˆ—ç±»å‹
TYPE basic
# åº”è¯¥è¿”å›: list

# 4. æŸ¥çœ‹é˜Ÿåˆ—æ˜¯å¦å­˜åœ¨
EXISTS basic
# è¿”å›: 1 (å­˜åœ¨) æˆ– 0 (ä¸å­˜åœ¨)
```

### ç›‘æ§é˜Ÿåˆ—å˜åŒ–

```bash
# æ–¹æ³• 1: ä½¿ç”¨ watch å‘½ä»¤ï¼ˆRedis 6.0+ï¼‰
WATCH basic
# ç„¶åæ‰§è¡Œå…¶ä»–æ“ä½œï¼Œå¦‚æœ basic è¢«ä¿®æ”¹ä¼šæ”¶åˆ°é€šçŸ¥

# æ–¹æ³• 2: ä½¿ç”¨ Python è„šæœ¬å¾ªç¯æŸ¥çœ‹
python3 queue_monitor.py
```

### æ¸…ç©ºé˜Ÿåˆ—ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰

```bash
# åˆ é™¤é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡
DEL basic

# æˆ–ä½¿ç”¨ LTRIMï¼ˆä¿ç•™ç©ºåˆ—è¡¨ï¼‰
LTRIM basic 1 0
```

---

## ğŸ“Š å®é™…ç¤ºä¾‹

### ç¤ºä¾‹ 1: æŸ¥çœ‹ basic é˜Ÿåˆ—

```bash
$ redis-cli
127.0.0.1:6379> LLEN basic
(integer) 3

127.0.0.1:6379> LRANGE basic 0 -1
1) "{\"id\":\"abc123...\",\"task\":\"tasks.basic_tasks.hello_world\",\"args\":[42,42],...}"
2) "{\"id\":\"def456...\",\"task\":\"tasks.basic_tasks.add\",\"args\":[4,5],...}"
3) "{\"id\":\"ghi789...\",\"task\":\"tasks.basic_tasks.multiply\",\"args\":[6,7],...}"
```

### ç¤ºä¾‹ 2: æ ¼å¼åŒ–æŸ¥çœ‹ä»»åŠ¡

```bash
# è·å–ç¬¬ä¸€ä¸ªä»»åŠ¡å¹¶æ ¼å¼åŒ–
$ redis-cli LRANGE basic 0 0 | python3 -m json.tool
[
    {
        "id": "abc123-def456-ghi789",
        "task": "tasks.basic_tasks.hello_world",
        "args": [42, 42],
        "kwargs": {},
        "retries": 0,
        "eta": null,
        "expires": null
    }
]
```

### ç¤ºä¾‹ 3: ä½¿ç”¨ Python è„šæœ¬æŸ¥çœ‹

```bash
$ python3 examples/view_redis_queue.py

============================================================
æŸ¥çœ‹ Redis basic é˜Ÿåˆ—
============================================================

Redis è¿æ¥: redis://localhost:6379/0
  ä¸»æœº: localhost
  ç«¯å£: 6379
  æ•°æ®åº“: 0
  å¯†ç : (æ— )

âœ… Redis è¿æ¥æˆåŠŸ

ğŸ“¦ é˜Ÿåˆ—: basic
--------------------------------------------------------------------------------
é˜Ÿåˆ—é•¿åº¦: 3 ä¸ªä»»åŠ¡

é˜Ÿåˆ—å†…å®¹ï¼ˆå‰ 10 ä¸ªä»»åŠ¡ï¼Œä¸åˆ é™¤ï¼‰:
--------------------------------------------------------------------------------

[1] ä»»åŠ¡æ¶ˆæ¯:
   ä»»åŠ¡ID: abc123-def456-ghi789
   ä»»åŠ¡åç§°: tasks.basic_tasks.hello_world
   å‚æ•°: args=[42, 42], kwargs={}
   é‡è¯•æ¬¡æ•°: 0
   å®Œæ•´æ¶ˆæ¯: {"id":"abc123...","task":"tasks.basic_tasks.hello_world",...}
```

---

## ğŸ¯ å¸¸ç”¨åœºæ™¯

### åœºæ™¯ 1: æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦æœ‰ç§¯å‹

```bash
redis-cli LLEN basic
# å¦‚æœè¿”å›å¾ˆå¤§çš„æ•°å­—ï¼Œè¯´æ˜é˜Ÿåˆ—ç§¯å‹
```

### åœºæ™¯ 2: æŸ¥çœ‹é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡è¯¦æƒ…

```bash
# ä½¿ç”¨ Python è„šæœ¬ï¼ˆæ¨èï¼‰
python3 examples/view_redis_queue.py

# æˆ–ä½¿ç”¨ Redis CLI + jq
redis-cli LRANGE basic 0 0 | jq .
```

### åœºæ™¯ 3: è°ƒè¯•ä»»åŠ¡é—®é¢˜

```bash
# 1. æŸ¥çœ‹é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡
redis-cli LRANGE basic 0 -1

# 2. æŸ¥çœ‹ä»»åŠ¡ç»“æœ
redis-cli GET celery-task-meta-{task_id}

# 3. æŸ¥çœ‹ Worker çŠ¶æ€
python3 queue_monitor.py
```

### åœºæ™¯ 4: æ¸…ç†é˜Ÿåˆ—

```bash
# æ¸…ç©º basic é˜Ÿåˆ—ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
redis-cli DEL basic
```

---

## ğŸ’¡ æç¤ºå’Œæ³¨æ„äº‹é¡¹

### 1. LRANGE vs BRPOP

- **LRANGE**: æŸ¥çœ‹ä»»åŠ¡ï¼Œ**ä¸åˆ é™¤**
- **BRPOP**: è·å–ä»»åŠ¡ï¼Œ**ä¼šåˆ é™¤**ï¼ˆWorker ä½¿ç”¨çš„æ–¹å¼ï¼‰

### 2. é˜Ÿåˆ—åç§°

- Celery é»˜è®¤é˜Ÿåˆ—: `celery`
- è‡ªå®šä¹‰é˜Ÿåˆ—: `basic`, `advanced`, `realworld` ç­‰
- é˜Ÿåˆ—åç§°åœ¨ `task_routes` ä¸­é…ç½®

### 3. æ¶ˆæ¯æ ¼å¼

- æ¶ˆæ¯æ˜¯ JSON å­—ç¬¦ä¸²
- åŒ…å«ä»»åŠ¡ IDã€ä»»åŠ¡åç§°ã€å‚æ•°ç­‰ä¿¡æ¯
- å¯ä»¥ä½¿ç”¨ `json.tool` æˆ– `jq` æ ¼å¼åŒ–

### 4. æ€§èƒ½è€ƒè™‘

- `LRANGE 0 -1` ä¼šè¿”å›æ‰€æœ‰ä»»åŠ¡ï¼Œå¦‚æœé˜Ÿåˆ—å¾ˆå¤§å¯èƒ½å¾ˆæ…¢
- å»ºè®®ä½¿ç”¨ `LRANGE 0 9` åªæŸ¥çœ‹å‰ 10 ä¸ª
- ä½¿ç”¨ `LLEN` å…ˆæŸ¥çœ‹é˜Ÿåˆ—é•¿åº¦

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: é˜Ÿåˆ—ä¸å­˜åœ¨

```bash
# æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦å­˜åœ¨
redis-cli EXISTS basic
# è¿”å› 0 è¡¨ç¤ºä¸å­˜åœ¨

# å¯èƒ½çš„åŸå› :
# - é˜Ÿåˆ—åç§°é”™è¯¯
# - è¿˜æ²¡æœ‰ä»»åŠ¡æäº¤åˆ°è¯¥é˜Ÿåˆ—
# - Worker è¿˜æ²¡æœ‰åˆ›å»ºé˜Ÿåˆ—
```

### é—®é¢˜ 2: æ— æ³•è¿æ¥ Redis

```bash
# æµ‹è¯•è¿æ¥
redis-cli ping
# åº”è¯¥è¿”å›: PONG

# å¦‚æœå¤±è´¥ï¼Œæ£€æŸ¥:
# - Redis æ˜¯å¦è¿è¡Œ
# - ä¸»æœºå’Œç«¯å£æ˜¯å¦æ­£ç¡®
# - å¯†ç æ˜¯å¦æ­£ç¡®
```

### é—®é¢˜ 3: æ¶ˆæ¯æ ¼å¼æ— æ³•è§£æ

```bash
# æŸ¥çœ‹åŸå§‹æ¶ˆæ¯
redis-cli LRANGE basic 0 0

# å¦‚æœæ¶ˆæ¯ä¸æ˜¯ JSON æ ¼å¼ï¼Œå¯èƒ½æ˜¯:
# - åºåˆ—åŒ–æ ¼å¼ä¸æ˜¯ JSON
# - æ¶ˆæ¯æŸå
# - ä½¿ç”¨äº†å…¶ä»–åºåˆ—åŒ–å™¨ï¼ˆpickle ç­‰ï¼‰
```

---

## ğŸ“š ç›¸å…³å·¥å…·

1. **view_redis_queue.py**: æŸ¥çœ‹ basic é˜Ÿåˆ—çš„ä¸“ç”¨è„šæœ¬
2. **redis_queue_viewer.py**: æŸ¥çœ‹æ‰€æœ‰é˜Ÿåˆ—çš„é€šç”¨å·¥å…·
3. **queue_monitor.py**: å®æ—¶ç›‘æ§é˜Ÿåˆ—å˜åŒ–
4. **test_redis_connection.py**: æµ‹è¯• Redis è¿æ¥

---

**ç°åœ¨ä½ å¯ä»¥è½»æ¾æŸ¥çœ‹ Redis ä¸­çš„ basic é˜Ÿåˆ—äº†ï¼** ğŸ‰

